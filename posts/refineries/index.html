<!doctype html><html class=no-js lang=en-us></html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Refineries optimization: from Data Science to Financial Engineering</title><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.96.0"><link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&family=Poppins&display=swap" rel=stylesheet><link rel=stylesheet href=https://rolozanod.github.io/css/bootstrap.min.css><link rel=stylesheet href=https://rolozanod.github.io/css/themefisher-fonts.css><link rel=stylesheet href=https://rolozanod.github.io/css/font-awesome.min.css><link rel=stylesheet href=https://rolozanod.github.io/plugins/font-awesome/css/font-awesome.min.css><link rel=stylesheet href=https://rolozanod.github.io/css/owl.carousel.css><link rel=stylesheet href=https://rolozanod.github.io/css/animate.css><link rel=stylesheet href=https://rolozanod.github.io/css/style.css><link rel=stylesheet href=https://rolozanod.github.io/scss/style.min.css><link rel="shortcut icon" href=https://rolozanod.github.io/images/rl.ico type=image/x-icon><link rel=icon href=https://rolozanod.github.io/images/rl.ico type=image/x-icon><link rel=stylesheet href=https://rolozanod.github.io/css/responsive.css><link rel=stylesheet href=https://rolozanod.github.io/css/bootstrap-table.css><script src=https://cdn.plot.ly/plotly-latest.min.js></script>
<script>console.log("Welcome to my site!")</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script>
<script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"]]},loader:{load:["ui/safe"]}}</script></head><body id=body><div id=preloader><div class=book><div class=book__page></div><div class=book__page></div><div class=book__page></div></div></div><div class=container><nav class="navbar navbar-fixed-top navigation" id=top-nav><a class="navbar-brand float-none float-lg-left" href=https://rolozanod.github.io><img src=https://rolozanod.github.io/images/rl.ico alt=logo></a>
<button class="navbar-toggler hidden-lg-up float-lg-right" type=button data-toggle=collapse data-target=#navbarResponsive>
<i class=tf-ion-android-menu></i></button><div class="collapse navbar-toggleable-md" id=navbarResponsive><ul class="nav navbar-nav menu float-lg-right" id=top-nav><li class="nav-item active"><a class=nav-link href=https://rolozanod.github.io#home>Home</a></li><li class=nav-item><a class=nav-link href=https://rolozanod.github.io#about>About</a></li><li class=nav-item><a class=nav-link href=https://rolozanod.github.io#service>Skills</a></li><li class=nav-item><a class=nav-link href=https://rolozanod.github.io#posts>Posts</a></li></ul></div></nav></div><div id=content><section class="blog-single section"><div class=container><div class=row><div class="col-lg-2 order-2 order-lg-1"><div class=share-now><a href=# class=scrol>Share</a><div class=sociel-icon><ul><li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2frolozanod.github.io%2fposts%2frefineries%2f" target=_blank><i class="fa fa-facebook"></i></a></li><li><a href="http://www.twitter.com/intent/tweet?url=https%3a%2f%2frolozanod.github.io%2fposts%2frefineries%2f" target=_blank><i class="fa fa-twitter"></i></a></li><li><a href="https://www.linkedin.com/cws/share?url=https%3a%2f%2frolozanod.github.io%2fposts%2frefineries%2f" target=_blank><i class="fa fa-linkedin"></i></a></li></ul></div></div></div><div class="col-lg-10 order-1 order-lg-2"><article class=single-blog><a href=https://rolozanod.github.io/tags/strategic%20planning class=tag>strategic planning</a><p class=title>Refineries optimization: from Data Science to Financial Engineering</p><ul class=meta><li>By <a href=https://rolozanod.github.io/about>Rodrigo Lozano</a></li><li><i class="fa fa-clock-o"></i>
December 23, 2024 - 30 min read</li></ul><div class=feature-image><img src=https://rolozanod.github.io/images/blog/feature-refineries-image.jpg alt=banner></div><div class=single-blog-content><h1 id=optimizing-the-decision-making-of-a-strategic-project-under-uncertainty>Optimizing the decision-making of a strategic project under uncertainty</h1><br><h3 id=laying-out-the-theoretical-business-case>Laying out the theoretical business case</h3><p>This case study demonstrates the application of various data science techniques, integrated with finance and strategic planning, to improve data-driven decision-making processes. The aim is to recommend the optimal execution of projects, even under uncertain conditions.</p><br><blockquote><p>Disclaimer: This is a theoretical business case. Production and distribution costs, as well as most expansion projects (excluding Dos Bocas), are random. Details are provided at the end of this post.</p></blockquote><br><p>A theoretical portfolio of expansion projects is provided in the table below. It consists of expansions at existing facilities (brownfield projects) or new production sites (greenfield projects). Their profitability is to be determined through Mixed Integer Linear Programming and Monte Carlo methods for diverse supply and demand scenarios.</p><br><div class=table-responsive><table class="table table-striped table-hover"><thead class=table-info><tr><th style=text-align:center>PLANT</th><th style=text-align:left>PROJECT TYPE</th><th style=text-align:center>CAPEX (M MXN)</th><th style=text-align:center>CAPACITY (M LITERS PER DAY)</th></tr></thead><tbody><tr><td style=text-align:center>Cadereyta</td><td style=text-align:left>Brownfield</td><td style=text-align:center>100,000</td><td style=text-align:center>4.3 (+40%)</td></tr><tr><td style=text-align:center>Cangrejera</td><td style=text-align:left>Brownfield</td><td style=text-align:center>75,000</td><td style=text-align:center>4.9 (N/A)</td></tr><tr><td style=text-align:center>Dos Bocas</td><td style=text-align:left>Greenfield</td><td style=text-align:center>336,320</td><td style=text-align:center>33.8 (N/A)</td></tr><tr><td style=text-align:center>Madero</td><td style=text-align:left>Brownfield</td><td style=text-align:center>100,000</td><td style=text-align:center>1.9 (+30%)</td></tr><tr><td style=text-align:center>Minatitlan</td><td style=text-align:left>Brownfield</td><td style=text-align:center>75,000</td><td style=text-align:center>2.6 (+40%)</td></tr><tr><td style=text-align:center>Salamanca</td><td style=text-align:left>Brownfield</td><td style=text-align:center>75,000</td><td style=text-align:center>2.3 (+40%)</td></tr><tr><td style=text-align:center>Salina Cruz</td><td style=text-align:left>Brownfield</td><td style=text-align:center>150,000</td><td style=text-align:center>3.7 (+30%)</td></tr><tr><td style=text-align:center>Tula</td><td style=text-align:left>Brownfield</td><td style=text-align:center>150,000</td><td style=text-align:center>2.1 (+30%)</td></tr></tbody></table></div><br><h3 id=developing-the-monte-carlo-approach-to-tackle-uncertainty-challenges>Developing the Monte Carlo approach to tackle uncertainty challenges</h3><p>For each location in Mexico, 1,000 simulations were conducted, considering variables such as demand, price, and supply costs.</p><br><p>Scenarios for price and demand are generated using an Artificial Neural Network (ANN) with an Auto Variational Encoder (AVE) structure that uses machine learning to create new data based on training data.</p><br><p>The figure below includes two graphs: the left graph shows fuel demand, while the right graph displays the price at the pump. These graphs aggregate data for Mexico, derived from estimates across 792 locations over the 1,000 scenarios.</p><div id=/plotly/plotly-hugo/REFINERIES/demands.json class=plotly style=height:600px></div><script>Plotly.d3.json("/plotly/plotly-hugo/REFINERIES/demands.json",function(t,e){Plotly.plot("/plotly/plotly-hugo/REFINERIES/demands.json",e.data,e.layout,{responsive:!0})})</script><h3 id=using-the-mixed-integer-optimization-model-to-determine-profitability>Using the Mixed Integer Optimization model to determine profitability</h3><p>These estimates are fed into the optimization model to determine which projects are executed based on supply and demand conditions for each scenario.</p><br><p>The optimization model will maximize the <a href=https://www.investopedia.com/terms/d/dcf.asp>Discounted Free Cashflow (DCF)</a> of the system of plants under each of the 1,000 scenarios. The result of the optimization model is the production output at each refinery and their supply requirements for each market.</p><br><p>Embedding the CAPEX in the optimization of the DCF is helpful as it enables the model to make the best investment decision on profitable expansions instead of running a business-case for each project on its own to determine if they are profitable under each scenario.</p><br><p>The decision to execute each project under the optimization model is shown in the graph below where it is displayed as the percentage of scenarios where the capacity expansion occurred at each refinery over the 1,000 iterations.</p><div id=/plotly/plotly-hugo/REFINERIES/expansions_distn.json class=plotly style=height:400px></div><script>Plotly.d3.json("/plotly/plotly-hugo/REFINERIES/expansions_distn.json",function(t,e){Plotly.plot("/plotly/plotly-hugo/REFINERIES/expansions_distn.json",e.data,e.layout,{responsive:!0})})</script><br><h3 id=analyzing-the-profitability-of-each-project-with-a-discounted-cashflow-approach>Analyzing the profitability of each project with a Discounted Cashflow approach</h3><p>Each project is evaluated by the optimization model using the DCF method, comparing the Free Cash Flow (FCF) generated by each plant with an expansion to the base case.</p><br><p>Each scenario then has a target and a base case, both have the same demand, price and costs but capacity is allowed to increase if the CAPEX is executed in the target case and it cannot increase in the base case.</p><br><p>This allows for an isolated analysis of the benefits generated by the project under equal market conditions but with increased capacity.</p><br><p>Below is a violin plot that shows the Net Present Value (NPV) of the FCF generated by each plant when allowed to increase capacity over the 1,000 scenarios.</p><div id=/plotly/plotly-hugo/REFINERIES/npv_fcf_distn.json class=plotly style=height:600px></div><script>Plotly.d3.json("/plotly/plotly-hugo/REFINERIES/npv_fcf_distn.json",function(t,e){Plotly.plot("/plotly/plotly-hugo/REFINERIES/npv_fcf_distn.json",e.data,e.layout,{responsive:!0})})</script><br><p>As shown in the violin plot, sometimes a project will generate negative FCF. This happens because a plant might incur a loss due to increased distribution costs, while other plants reduce their overall costs (production and/or distribution), thereby generating a benefit for the system.</p><br><p>This can be corroborated in the plot below that shows the distribution of the DCF for 1,000 scenarios at system level instead for each plant. All values remain positive at system level even when some plants generated less FCF when compared to the base case.</p><div id=/plotly/plotly-hugo/REFINERIES/syst_npv_fcf_distn.json class=plotly style=height:600px></div><script>Plotly.d3.json("/plotly/plotly-hugo/REFINERIES/syst_npv_fcf_distn.json",function(t,e){Plotly.plot("/plotly/plotly-hugo/REFINERIES/syst_npv_fcf_distn.json",e.data,e.layout,{responsive:!0})})</script><br><p><strong>This is what the optimization model achieves, systemic and integral benefits along the value chain.</strong></p><br><h3 id=leveraging-the-real-option-valuation-on-the-generated-data-to-enhance-the-decision-making-process>Leveraging the Real Option valuation on the generated data to enhance the decision-making process</h3><br><p>The optimization of 1,000 scenarios provides the foundation for robust investment decisions. As shown in previous violin plots and the one below, Some expansions may underperform in unfavorable market conditions, revealing diverse risk profiles which must be strategically considered.</p><br><div id=/plotly/plotly-hugo/REFINERIES/irr_distn.json class=plotly style=height:600px></div><script>Plotly.d3.json("/plotly/plotly-hugo/REFINERIES/irr_distn.json",function(t,e){Plotly.plot("/plotly/plotly-hugo/REFINERIES/irr_distn.json",e.data,e.layout,{responsive:!0})})</script><br><p>Real Options can support in this matter. This method extends the concept of <a href=https://en.wikipedia.org/wiki/Option_(finance)>options</a> from financial derivatives to assess the fair value of a project considering the inherent risk exposure and potential upsides.</p><br><p>Consider the scenario where the company has to decide to purchase the land and spend in engineering studies for the project. These land and studies enable the company to access the future benefits if the project is executed.</p><br><p>The benefits were estimated through the DCF analysis over 1,000 simulations with an expected value (\(S_0\)) and its respective risk (\({\sigma}^2\)). Moreover, the CAPEX for the execution of the project resembles the strike price (\(K\)).</p><br><p>Management has an investment window of five years to decide on the execution of the project, depending on how economic conditions develop.</p><br><p>An <a href=https://en.wikipedia.org/wiki/Option_style>american call option</a> resembles this situation where the decision to build the plant can be done within the 5 years. The value of the american option extends the traditional DCF and sets an upperbound for land and engineering.</p><br><p>In this case, the value of the project to hedge in the real option (\( S_0 \)) will be defined under a conservative case so the value of the real option does not commit benefits above the \(25^{th}\) percentile.</p><br><p>Below is the plot that shows the expected value, hedged value and real option value as a ratio to expansion CAPEX for each plant.</p><div id=/plotly/plotly-hugo/REFINERIES/real_option.json class=plotly style=height:600px></div><script>Plotly.d3.json("/plotly/plotly-hugo/REFINERIES/real_option.json",function(t,e){Plotly.plot("/plotly/plotly-hugo/REFINERIES/real_option.json",e.data,e.layout,{responsive:!0})})</script><br><div class=table-responsive><table class="table table-striped table-hover"><thead class=table-info><tr><th style=text-align:center>PLANT</th><th style=text-align:center>DCF (M MXN)</th><th style=text-align:center>HEDGE (M MXN)</th><th style=text-align:center>OPTION (M MXN)</th><th style=text-align:center>Ext DCF (M MXN)</th></tr></thead><tbody><tr><td style=text-align:center>Cadereyta</td><td style=text-align:center>96,842</td><td style=text-align:center>81,766</td><td style=text-align:center>1,026</td><td style=text-align:center>97,868</td></tr><tr><td style=text-align:center>Cangrejera</td><td style=text-align:center>114,583</td><td style=text-align:center>96,550</td><td style=text-align:center>21,590</td><td style=text-align:center>136,173</td></tr><tr><td style=text-align:center>Dos Bocas</td><td style=text-align:center>466,398</td><td style=text-align:center>403,926</td><td style=text-align:center>68,543</td><td style=text-align:center>534,941</td></tr><tr><td style=text-align:center>Madero</td><td style=text-align:center>-945</td><td style=text-align:center>-5,252</td><td style=text-align:center></td><td style=text-align:center>-945</td></tr><tr><td style=text-align:center>Minatitlan</td><td style=text-align:center>10,902</td><td style=text-align:center>-3,536</td><td style=text-align:center></td><td style=text-align:center>10,902</td></tr><tr><td style=text-align:center>Salamanca</td><td style=text-align:center>47,239</td><td style=text-align:center>42,377</td><td style=text-align:center>2</td><td style=text-align:center>47,241</td></tr><tr><td style=text-align:center>Salina Cruz</td><td style=text-align:center>3,702</td><td style=text-align:center>-5,376</td><td style=text-align:center></td><td style=text-align:center>3,702</td></tr><tr><td style=text-align:center>Tula</td><td style=text-align:center>-1,013</td><td style=text-align:center>-4,061</td><td style=text-align:center></td><td style=text-align:center>-1,013</td></tr></tbody></table></div><br><p>Moreover, the table above denotes the value granted by the flexibility to excecute the expansion in 5 years instead of committing beforehand.</p><br><p>Dos Bocas has the highest option value of 69 B MXN with a traditional DCF of 466 B MXN and a CAPEX of 336 B MXN. The extended NPV, which considers the real option value, is 535 B MXN.<br>The company should not spend more than the real option value on land and engineering, as doing so would jeopardize the value of flexibility and commit FCF beyond the \(25^{th}\) threshold.</p><br><p>Considering the analysis so far, if the company were to commit to build Dos Bocas, Cangrejera, Cadereyta and Salamanca, the capacity expansions could be seen through a <em>symbolic</em> stock performance.</p><br><p>Assuming an all-equity firm, the \(\text{DCF}_{t}\) at each timestep accounting for perpetuity will be divided by a symbolic amount of 130 B stocks (1,000 per mexican), this yields an increase of +6.9 MXN/stock (+3.1%, +902 B DCF) to current valuation.</p><br><div class=table-responsive><table class="table table-striped table-hover"><thead class=table-info><tr><th style=text-align:center>Scenario</th><th style=text-align:center>Now</th><th style=text-align:center>5y</th><th style=text-align:center>10y</th><th style=text-align:center>15y</th><th style=text-align:center>20y</th></tr></thead><tbody><tr><td style=text-align:center>Base case</td><td style=text-align:center>2,220.7</td><td style=text-align:center>2,323.9</td><td style=text-align:center>2,734.4</td><td style=text-align:center>3,436.8</td><td style=text-align:center>3,677.1</td></tr><tr><td style=text-align:center>Optimized</td><td style=text-align:center>2,227.6</td><td style=text-align:center>2,336.2</td><td style=text-align:center>2,746.3</td><td style=text-align:center>3,448.5</td><td style=text-align:center>3,688.5</td></tr><tr><td style=text-align:center>Delta</td><td style=text-align:center>6.9</td><td style=text-align:center>12.3</td><td style=text-align:center>11.9</td><td style=text-align:center>11.7</td><td style=text-align:center>11.4</td></tr></tbody></table></div><br><p>Investors willing to inject capital into this pool of projects (586 B MXN) could hedge through an option on the stock.<br>Executing a put option with a strike price at 2,336.2 \(\frac{\text{MXN}}{\text{share}}\) with ~20 B positions would hedge the expected premium on the DCF of +902 B MXN derived from expansion projects upon reaching comisioning in year 5.</p><p>$$ \text{20 B} = \frac{ \text{902 B MXN} }{ \text{2,336.2 MXN/share} - \text{2,320.7 MXN/share} - \text{70.4 MXN/share}} $$</p><p>where 70.4 \(\frac{\text{MXN}}{\text{share}}\) is the fair value of a put option under Black-Scholes model.</p><p>The challenge is that the 20 B value represents 15% of floating stocks.</p><br><h2 id=wrapping-up>Wrapping up</h2><br><p>Throughout the business case, the retrieval of data and forecasting of multiple scenarios using Machine Learning laid the foundation for a robust analysis. The use of optimization techniques to assess the value of assets under potential expansions revealed their contribution and dependence within the system.</p><br><p>Translating these contributions into financial performance highlighted their attractiveness and risk profile. In particular, the value of flexibility through Real Options helped determine a fair valuation in expanding the understanding of the project through land aquisition, feasibility, and engineering expenses.</p><br><p>Moreover, the use of financial options helped hedge capital exposure for the projects and revealed the stress reflected in the market.</p><br><p>Large capital projects like these require nimble strategic and financial analysis. Coordination between public and private efforts is essential to ensure their success, particularly when innovating on investment vehicles and incentives to democratize access to energy. These complex financial structures—such as tax incentives attracting tax-equity investors and loan syndication—emerge throughout the life of the project.</p><blockquote><p>Disclaimer: This is a theoretical business case.</p><blockquote><ol><li>Historical demand and prices were retrieved from <strong><a href=http://transparenciacre.westcentralus.cloudapp.azure.com/PNT/73/III/E/PL/Precios_promedio_diarios_y_mensuales_en_estaciones_de_servicio.xlsx>CRE data repository</a></strong></li><li>Demographic data was retrieved from <strong><a href=https://www.inegi.org.mx/programas/ccpv/2020/>INEGI&rsquo;s 2020 census</a></strong></li><li>Capacities are approximated with the production of 2020</li><li>Dos Bocas capacity was retrieved from the <strong><a href=https://dosbocas.energia.gob.mx/>official site</a></strong></li><li>All operationg costs (variable, fixed) are trivial and defined as a percentage of revenues.</li><li>Freight costs are estimated through a cost per liter-kilometer basis and using the distiance of each refinary to locations of consumption</li><li>Dos bocas CAPEX was retrieved from <strong><a href=https://dosbocas.energia.gob.mx/>official site</a></strong></li><li>All other CAPEX costs are trivial defined per current plant capacity</li></ol></blockquote></blockquote><h4 id=deep-dive>Deep dive:</h4><br><p>If you are interested in replicating a simpler version of this analysis head to <a href=https://github.com/rolozanod/mexico_fuel_guided_project/>my Github repo</a> and begin with <a href=https://github.com/rolozanod/mexico_fuel_guided_project/tree/main/Sessions>Session 0 notebook</a>.</p><br><h4 id=more-on-real-options>More on Real Options:</h4><br><p><strong><a href=https://en.wikipedia.org/wiki/Black%E2%80%93Scholes_model>Black and Scholes model</a></strong></p><p><strong><a href=http://people.stern.nyu.edu/adamodar/pdfiles/DSV2/Ch5.pdf>Real Options</a></strong></p><p><strong>Real Options Analysis by Johnathan Mun</strong> <strong><a href=https://www.amazon.com/Real-Options-Analysis-Techniques-Investment/dp/0471747483>Book</a></strong> <strong><a href=https://www.realoptionsvaluation.com/>Web page</a></strong></p></div></article><div class=blog-single-presentation><ul><li><a href=/posts/mexico_poverty/ class=tag>PREVIOUS</a>
<a href=/posts/mexico_poverty/ class=title>Clustering Mexico's neighborhoods and economic activities</a>
<i class="fa fa-clock-o"></i>
January 7, 2024 - 15 min</li></ul></div></div></div></div></section></div><footer class=footer><div class=container-fluid><div class=row><div class="col-lg-12 mx-auto text-center"><div class=block><p><a href=https://rolozanod.github.io>Rodrigo Lozano</a></p></div></div></div><div class=row><div class="col-lg-12 mx-auto text-center"><div class=sociale-icon><ul class=main-nav-social><li><a href=https://github.com/rolozanod/><i class="fa fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/rolozanod/><i class="fa fa-linkedin"></i></a></li></ul></div></div></div></div></footer><script src=https://rolozanod.github.io/js/vendor/jquery-2.1.1.min.js></script>
<script src=https://rolozanod.github.io/js/bootstrap.min.js></script>
<script src=https://rolozanod.github.io/js/vendor/modernizr-2.6.2.min.js></script>
<script src=https://rolozanod.github.io/js/jquery.lwtCountdown-1.0.js></script>
<script src=https://rolozanod.github.io/js/owl.carousel.min.js></script>
<script src=https://rolozanod.github.io/js/jquery.validate.min.js></script>
<script src=https://rolozanod.github.io/js/jquery.form.js></script>
<script src=https://rolozanod.github.io/js/jquery.nav.js></script>
<script src=https://rolozanod.github.io/js/wow.min.js></script>
<script src=https://rolozanod.github.io/js/main.js></script></body></html></body></html>